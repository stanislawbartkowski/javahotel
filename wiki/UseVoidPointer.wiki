==Top secret usage of void pointer==

===secret.h===

{{{
#include <string>

typedef void* secretpointer;

secretpointer newSecret();

void deleteSecret(secretpointer p);

std::string revealSecret(secretpointer p);
}}}

===secret.cpp===

#include "secret.h"

{{{
#include <string>

typedef struct {
    std::string secret;
} secret;

secretpointer newSecret() {
    return new secret;
}

void deleteSecret(secretpointer v) {
     secret *p = static_cast<secret *>(v);
     delete p;
}

std::string revealSecret(secretpointer v) {
     secret *p = static_cast<secret *>(v);
     p->secret = "top secret message";
     return p->secret;
}
}}}

===main.cpp===

{{{
#include <iostream>
#include <cstdlib>
#include "secret.h"

using namespace std;

int main(int argc, char *argv[])
{
    secretpointer p = newSecret();
    cout << "Secret:" << revealSecret(p) << endl; 
    deleteSecret(p);
    return EXIT_SUCCESS;
}
}}}